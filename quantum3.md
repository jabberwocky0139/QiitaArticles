<!---
	Python語訳 Cousera - Machine Learning: 回帰・分類
-->

# あらまし
Couseraの機械学習コースをはじめました．前々から視界にはかすめていたのですが、やっと今頃重い腰を上げた次第です．しかし、Octaveで書くのが少々億劫[^1]だったこと、コードの一部を埋めるのではなくインターフェイスから全て自分で書いたほうが勉強になると思い、Pythonで書き直してみることにしました．  

この記事は自分の勉強メモです．Pythonで書き直している人は自分以外にもたくさん居ますし、Couseraの内容全てをカバーするわけでもなく、もちろん自分は専門家でもありません．学問的に厳密な記述はしません、というかできません．  

巷に溢れる機械学習の教材のひとつとして、利用して頂けると幸いです．

# 機械学習のキモ
機械学習で登場する重要キャラクターの紹介です．5人います:

1. $X$: 入力データセット．例えば①土地の広さとか、②タイタニック号乗船者の性別・年齢とかとか  
2. $y$: 出力データセット．例えば①に対する価格とか、②に対する生還可否とか．  

これが「教師」にあたります．**この入力$X$に対して出力$y$を返すような関数を見つけることが機械学習の主目的です．**__

3. $h_{\theta}$: 仮説(hypothesis)関数．$h_{\theta}(X) \simeq y$ となるような$h$を見つけたい．そうすれば、土地の広さに対する価格を予測できたり、タイタニック号に乗るか否かの判断を理知的に下すことができる．すごい  

機械学習はその名の通り、データセットを使って$h_{\theta}(X)\simeq y$を満たすように$h_{\theta}$鍛えていきます．勉強なら脳みそ、運動なら筋肉、**パラメータ$\theta$こそが機械学習における脳みそ・筋肉です**__

4. $\theta$: 仮説関数に含まれるパラメータ．この$\theta$を弄って、$h_{\theta}(X) \simeq y$を実現したい．__

ではどのようにして$\theta$を決定するか．そのアイデアはシンプルです．**$h_{\theta}(X) = y$からのズレを定量化してそのズレを最小化するような$\theta$を見つければよいのです．** ズレが少なければ$h_{\theta}(X) \simeq y$としてよかろう、ということです．そのズレをコスト関数と呼びます__

5. $J(\theta)$: コスト関数．$X, y, \theta$を使った理想からズレとして定義されます．これを最小化していく過程を「学習」と呼びます．__


以上が概略になります．これだけだと、そんなに難しくなさそうですね．機械学習におけるモデルとは

- 仮説関数をどのように定義するか
- コスト関数をどのように定義するか

の2点に集約されます．$J(\theta)$を最小化するのは単なる数学(最適化問題)です．その手のことはPython様はお手の物です.

# その1: 線形回帰
以下のような分布があったとします
[]

横軸が都市の人口、縦軸がその都市にあるレストランの売上です．横軸が$X$、縦軸が$y$に相当します[^2]．都市の人口を入力したらレストランの売上を吐き出す関数$h_\theta$を求めていきましょう．ひとまず、$h_\theta$がどんな関数になるかを考えてみましょう:
[]

だいたいこんなかんじでしょうか．$h_\theta$を直線と仮定してあげるのがよさそうですね．$h_\theta(17.5) = 18$てなもんでしょう(雑)．__
入力$X$を引数に取り、$\theta$を含み、線形関数となれば自ずと形は決まってきますね:

$$
h_\theta(X) = \Theta^T X = \theta_0 + \theta_1 x_1\\
X = (x_0, x_1) = (1, x_1)\\
\Theta = (\theta_0, \theta_1)
$$

このモデルにおける筋肉は、直線の傾きと切片なわけですね．__

次にコスト関数を定義しましょう．コスト関数とは理想とのズレです
[]

いくつかの点について誤差を緑矢印で示しました．この誤差を全ての点について取ってあげて足し合わせればコスト関数の出来上がりです．ただし、上側にズレてても下側にズレてても等価なので、符号を打ち消すために2乗してあげましょう:

$$
J(\theta) = \sum (h(x^{(i)} - y^{(i)})
$$






[^1]: Couseraの機械学習コース内ではOctaveを使用して課題を解いていきます．Python(NumPy)よりも初学者にとってとっつきやすいとのこと．たしかにそうかも
[^2]: 単位はそれっぽくスケーリングしています



